import numpy as np
import streamlit as st
import matplotlib.pyplot as plt

# =========================================================
# –§–£–ù–ö–¶–ò–Ø –†–ê–°–ß–ï–¢–ê –ö–¢–ì
# =========================================================
def calculate_ktg(
    ktg_zakl: float,      # –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì (–¥–æ–ª—è –æ—Ç 0 –¥–æ 1)
    t_vosst_sist: float,  # –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã, —á–∞—Å
    t_vosst_isx: float    # –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è, —á–∞—Å
) -> float:
    """
    –†–∞—Å—á–µ—Ç –ö–¢–ì –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –†–í–î.
    
    –§–æ—Ä–º—É–ª–∞: –ö–¢–ì = –ö–¢–ì–∑–∞–∫–ª * T–≤–æ—Å—Å—Ç—Å–∏—Å—Ç / T–≤–æ—Å—Å—Ç–∏—Å—Ö–æ–¥
    """
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
    if t_vosst_isx <= 0:
        return 0
    
    # –†–∞—Å—á–µ—Ç –ö–¢–ì –ø–æ —Ñ–æ—Ä–º—É–ª–µ
    ktg = ktg_zakl * t_vosst_sist / t_vosst_isx
    
    # –ö–¢–ì –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
    return max(ktg, 0)

# =========================================================
# –ù–ê–°–¢–†–û–ô–ö–ò –°–¢–†–ê–ù–ò–¶–´
# =========================================================
st.set_page_config(
    page_title="–†–∞—Å—á—ë—Ç –ö–¢–ì –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –†–í–î",
    layout="wide"
)

st.title("–†–∞—Å—á—ë—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (–ö–¢–ì) –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –†–í–î")

# =========================================================
# –ë–ê–ó–û–í–´–ô –°–¶–ï–ù–ê–†–ò–ô
# =========================================================
BASE = {
    "ktg_zakl": 0.05,      # –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì (5%)
    "t_vosst_sist": 2.0,   # –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã, —á–∞—Å
}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è session_state
for key, value in BASE.items():
    if key not in st.session_state:
        st.session_state[key] = value

# =========================================================
# SIDEBAR ‚Äî –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–¶–ï–ù–ê–†–ò–ï–ú
# =========================================================
st.sidebar.header("–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–º")

if st.sidebar.button("üîÑ –°–±—Ä–æ—Å –∫ –±–∞–∑–æ–≤–æ–º—É —Å—Ü–µ–Ω–∞—Ä–∏—é"):
    for key, value in BASE.items():
        st.session_state[key] = value

# =========================================================
# SIDEBAR ‚Äî –ü–ê–†–ê–ú–ï–¢–†–´ –í–í–û–î–ê
# =========================================================
st.sidebar.markdown("### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞")

# –ó–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì
ktg_zakl = st.sidebar.slider(
    "–ó–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì –∏–∑-–∑–∞ –æ—Ç–∫–∞–∑–æ–≤ –†–í–î (–¥–æ–ª—è)",
    min_value=0.01,
    max_value=0.5,
    value=st.session_state["ktg_zakl"],
    step=0.01,
    help="–¢–µ–∫—É—â–∏–π –ö–¢–ì –ø–æ—Ç–µ—Ä—å –∏–∑-–∑–∞ –æ—Ç–∫–∞–∑–æ–≤ –†–í–î (–æ—Ç 1% –¥–æ 50%)",
    key="ktg_zakl"
)

# –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
t_vosst_sist = st.sidebar.number_input(
    "–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã, —á–∞—Å",
    min_value=0.5,
    max_value=10.0,
    value=st.session_state["t_vosst_sist"],
    step=0.5,
    help="–ü–ª–∞–Ω–æ–≤–æ–µ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –æ—Ç–∫–∞–∑–∞ –†–í–î –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è",
    key="t_vosst_sist"
)

# =========================================================
# –†–ê–°–ß–ï–¢ –ò –ì–†–ê–§–ò–ö
# =========================================================
# –î–∏–∞–ø–∞–∑–æ–Ω –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è (–æ—Å—å X)
t_vosst_isx_range = np.linspace(4, 24, 300)  # –æ—Ç 4 –¥–æ 24 —á–∞—Å–æ–≤

# –†–∞—Å—á–µ—Ç –ö–¢–ì –¥–ª—è –≤—Å–µ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
ktg_values = []
for t_vosst_isx in t_vosst_isx_range:
    ktg = calculate_ktg(ktg_zakl, t_vosst_sist, t_vosst_isx)
    ktg_values.append(ktg)

ktg_values = np.array(ktg_values)

# –†–∞—Å—á–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
ktg_4h = calculate_ktg(ktg_zakl, t_vosst_sist, 4)      # –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
ktg_12h = calculate_ktg(ktg_zakl, t_vosst_sist, 12)    # –ø—Ä–∏ —Å—Ä–µ–¥–Ω–µ–º –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
ktg_24h = calculate_ktg(ktg_zakl, t_vosst_sist, 24)    # –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

# =========================================================
# KPI - –ö–õ–Æ–ß–ï–í–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò
# =========================================================
st.markdown("### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏")

col1, col2, col3, col4 = st.columns(4)

col1.metric(
    label="–ö–¢–ì –ø—Ä–∏ 4 —á–∞—Å–∞—Ö –ø—Ä–æ—Å—Ç–æ—è",
    value=f"{ktg_4h:.3f}",
    delta=f"{(ktg_4h - ktg_zakl):.3f}" if ktg_4h != ktg_zakl else "0",
    delta_color="inverse"
)

col2.metric(
    label="–ö–¢–ì –ø—Ä–∏ 12 —á–∞—Å–∞—Ö –ø—Ä–æ—Å—Ç–æ—è",
    value=f"{ktg_12h:.3f}",
    delta=f"{(ktg_12h - ktg_zakl):.3f}" if ktg_12h != ktg_zakl else "0",
    delta_color="inverse"
)

col3.metric(
    label="–ö–¢–ì –ø—Ä–∏ 24 —á–∞—Å–∞—Ö –ø—Ä–æ—Å—Ç–æ—è",
    value=f"{ktg_24h:.3f}",
    delta=f"{(ktg_24h - ktg_zakl):.3f}" if ktg_24h != ktg_zakl else "0",
    delta_color="inverse"
)

col4.metric(
    label="–ó–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì",
    value=f"{ktg_zakl:.3f}",
    help="–ò—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ö–¢–ì –ø–æ—Ç–µ—Ä—å"
)

# =========================================================
# –ì–†–ê–§–ò–ö –ó–ê–í–ò–°–ò–ú–û–°–¢–ò
# =========================================================
fig, ax = plt.subplots(figsize=(10, 6))

# –û—Å–Ω–æ–≤–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫
ax.plot(t_vosst_isx_range, ktg_values, linewidth=2.5, color='royalblue', label='–ö–¢–ì –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è')

# –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è - –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì
ax.axhline(y=ktg_zakl, color='red', linestyle='--', alpha=0.7, label='–ó–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì')

# –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫
ax.axvline(x=4, color='gray', linestyle=':', alpha=0.5)
ax.axvline(x=12, color='gray', linestyle=':', alpha=0.5)
ax.axvline(x=24, color='gray', linestyle=':', alpha=0.5)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Å–µ–π –∏ —Å–µ—Ç–∫–∏
ax.set_xlabel("–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è (T–≤–æ—Å—Å—Ç–∏—Å—Ö–æ–¥), —á–∞—Å", fontsize=12)
ax.set_ylabel("–ö–¢–ì –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã", fontsize=12)
ax.set_title("–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ö–¢–ì –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –†–í–î", fontsize=14, pad=20)

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–µ–¥–µ–ª–æ–≤ –æ—Å–µ–π
ax.set_xlim(4, 24)
ax.set_ylim(0, max(ktg_zakl * 1.2, max(ktg_values) * 1.1))

# –°–µ—Ç–∫–∞
ax.grid(True, alpha=0.3)
ax.legend(loc='upper right')

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫
ax.annotate(f'–ö–¢–ì={ktg_4h:.3f}', xy=(4, ktg_4h), xytext=(5, ktg_4h + 0.005),
            arrowprops=dict(arrowstyle='->', color='black', alpha=0.7))
ax.annotate(f'–ö–¢–ì={ktg_12h:.3f}', xy=(12, ktg_12h), xytext=(13, ktg_12h + 0.005),
            arrowprops=dict(arrowstyle='->', color='black', alpha=0.7))
ax.annotate(f'–ö–¢–ì={ktg_24h:.3f}', xy=(24, ktg_24h), xytext=(19, ktg_24h + 0.005),
            arrowprops=dict(arrowstyle='->', color='black', alpha=0.7))

st.pyplot(fig)

# =========================================================
# –¢–ê–ë–õ–ò–¶–ê –ó–ù–ê–ß–ï–ù–ò–ô
# =========================================================
st.markdown("### –¢–∞–±–ª–∏—Ü–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ö–¢–ì")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –∫–ª—é—á–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
time_points = [4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24]
table_data = []

for time in time_points:
    ktg_val = calculate_ktg(ktg_zakl, t_vosst_sist, time)
    improvement = ((ktg_zakl - ktg_val) / ktg_zakl * 100) if ktg_zakl > 0 else 0
    table_data.append({
        "T–≤–æ—Å—Å—Ç–∏—Å—Ö–æ–¥, —á–∞—Å": time,
        "–ö–¢–ì": f"{ktg_val:.4f}",
        "–£–ª—É—á—à–µ–Ω–∏–µ, %": f"{improvement:.1f}%"
    })

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
st.table(table_data)

# =========================================================
# –û–ü–ò–°–ê–ù–ò–ï –°–¶–ï–ù–ê–†–ò–Ø –ò –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
# =========================================================
st.markdown("### –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è")

st.write(
    f"""
**–ó–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –ö–¢–ì –ø–æ—Ç–µ—Ä—å –∏–∑-–∑–∞ –æ—Ç–∫–∞–∑–æ–≤ –†–í–î:** {ktg_zakl:.3f} ({ktg_zakl*100:.1f}%)  
**–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:** {t_vosst_sist} —á–∞—Å  

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
1. –ü—Ä–∏ —Ç–µ–∫—É—â–µ–º –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è **12 —á–∞—Å–æ–≤** –ö–¢–ì –ø–æ—Ç–µ—Ä—å —Å–Ω–∏–∑–∏—Ç—Å—è –¥–æ **{ktg_12h:.4f}** ({ktg_12h*100:.2f}%)
2. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–Ω–∏–∂–µ–Ω–∏–∏ –ö–¢–ì –ø–æ—Ç–µ—Ä—å –Ω–∞ **{((ktg_zakl - ktg_12h)/ktg_zakl*100):.1f}%**
3. **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç** (–ø—Ä–∏ T–≤–æ—Å—Å—Ç–∏—Å—Ö–æ–¥ = 24 —á–∞—Å–∞): –ö–¢–ì = {ktg_24h:.4f}, —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ {((ktg_zakl - ktg_24h)/ktg_zakl*100):.1f}%
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç** (–ø—Ä–∏ T–≤–æ—Å—Å—Ç–∏—Å—Ö–æ–¥ = 4 —á–∞—Å–∞): –ö–¢–ì = {ktg_4h:.4f}, —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ {((ktg_zakl - ktg_4h)/ktg_zakl*100):.1f}%

**–í—ã–≤–æ–¥:** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –†–í–î –ø–æ–∑–≤–æ–ª–∏—Ç —Å–Ω–∏–∑–∏—Ç—å –ø–æ—Ç–µ—Ä–∏ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–∏ —Ç–µ—Ö–Ω–∏–∫–∏ 
–∑–∞ —Å—á–µ—Ç —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ {t_vosst_sist} —á–∞—Å–∞.
"""
)

# =========================================================
# –§–û–†–ú–£–õ–ê –†–ê–°–ß–ï–¢–ê
# =========================================================
st.markdown("### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞")

st.latex(r'''
–ö–¢–ì = –ö–¢–ì_{–∑–∞–∫–ª} \times \frac{T_{–≤–æ—Å—Å—Ç.—Å–∏—Å—Ç}}{T_{–≤–æ—Å—Å—Ç.–∏—Å—Ö}}
''')

st.write("–≥–¥–µ:")
st.write("- \(–ö–¢–ì_{–∑–∞–∫–ª}\) ‚Äî –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (–ø–æ—Ç–µ—Ä–∏ –∏–∑-–∑–∞ –æ—Ç–∫–∞–∑–æ–≤ –†–í–î)")
st.write("- \(T_{–≤–æ—Å—Å—Ç.—Å–∏—Å—Ç}\) ‚Äî –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–∏—Å—Ç–µ–º—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –†–í–î")
st.write("- \(T_{–≤–æ—Å—Å—Ç.–∏—Å—Ö}\) ‚Äî —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑ —Å–∏—Å—Ç–µ–º—ã")

# =========================================================
# –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø
# =========================================================
with st.expander("üìä –ö–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"):
    st.write("""
    **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ö–¢–ì:**
    - **–ö–¢–ì = 1.0** ‚Äî –∏–¥–µ–∞–ª—å–Ω–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ (100%, –ø–æ—Ç–µ—Ä—å –Ω–µ—Ç)
    - **–ö–¢–ì = 0.95** ‚Äî –ø–æ—Ç–µ—Ä–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç 5% —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    - **–ö–¢–ì = 0.90** ‚Äî –ø–æ—Ç–µ—Ä–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç 10% —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    
    **–ü—Ä–∏–º–µ—Ä:**
    - –ü—Ä–∏ –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ–º–æ–º –ö–¢–ì = 0.05 (5% –ø–æ—Ç–µ—Ä—å) –∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å 12 –¥–æ 2 —á–∞—Å–æ–≤:
      - –ù–æ–≤—ã–π –ö–¢–ì = 0.05 √ó (2 / 12) = 0.0083
      - –ü–æ—Ç–µ—Ä–∏ —Å–æ–∫—Ä–∞—Ç–∏–ª–∏—Å—å —Å 5% –¥–æ 0.83%
      - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 83.4%
    
    **–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏–µ –ö–¢–ì:**
    - –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ö–¢–ì –≤ —Ñ–æ—Ä–º—É–ª–µ –æ–∑–Ω–∞—á–∞–µ—Ç –°–ù–ò–ñ–ï–ù–ò–ï –ü–û–¢–ï–†–¨
    - –ß–µ–º –ú–ï–ù–¨–®–ï –ö–¢–ì –ø–æ—Ç–µ—Ä—å, —Ç–µ–º –ë–û–õ–¨–®–ï –≤—Ä–µ–º—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∏
    """)

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CSS –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
st.markdown("""
<style>
    .stMetric {
        background-color: #f0f2f6;
        padding: 10px;
        border-radius: 5px;
        border-left: 4px solid #4CAF50;
    }
    .stMetric label {
        font-weight: bold;
        color: #1E3A8A;
    }
</style>
""", unsafe_allow_html=True)